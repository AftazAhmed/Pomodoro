<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Pomodoro Tree ‚Äî Country Time Zone Picker</title>

  <style>
    :root{
      --bg:#eaf3ff; --surface:#ffffff; --surface-2:#eef6ff; --line:#caddf8;
      --text:#0b1a33; --dim:#4a6894;
      --radius-lg:18px; --shadow:0 10px 28px rgba(30,70,140,.1);
      --btn-text:#ffffff; --btn-primary:#2563eb; --btn-primary-hover:#1e40af;
      --btn-success:#16a34a; --btn-success-hover:#0f6a33;
      --btn-danger:#ef4444; --btn-danger-hover:#b91c1c;
      --btn-neutral:#334155; --btn-neutral-hover:#1f2937; --btn-focus:#0ea5e9;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; background:var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .wrap{ max-width:900px; margin:0 auto; padding:20px 16px 80px; }

    header{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:nowrap; }
    .brand{ display:flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px; background:linear-gradient(180deg,#f0f6ff,#ffffff); border:1px solid var(--line); white-space:nowrap; }
    h1{ margin:0; font-size:22px; }
    .modeTag{ font-weight:800; color:#14563a; font-size:18px; white-space:nowrap; }

    .card{ background:#fff; border:1px solid var(--line); border-radius:16px; padding:14px; box-shadow:var(--shadow); }

    .tzBar{ display:flex; flex-direction:column; gap:10px; margin-top:16px; }
    .tzRow{ display:flex; flex-direction:column; gap:8px; }
    .miniNote{ color:#4a6894; font-weight:700; }
    .searchWrap{ position:relative; }
    .searchWrap input{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--line); font-weight:700;
    }
    .dropdown{
      position:absolute; inset:unset; top:100%; left:0; right:0;
      background:#fff; border:1px solid #caddf8; border-radius:12px; max-height:260px; overflow:auto;
      box-shadow:0 10px 28px rgba(30,70,140,.1); z-index:20; display:none;
    }
    .drop-item{ padding:10px 12px; cursor:pointer; }
    .drop-item:hover{ background:#eef6ff; }

    .chips{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .chip{ padding:8px 12px; border-radius:999px; border:1px solid var(--line); background:#fff; color:#4a6894; }

    .controls{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    button{
      border:none; padding:10px 14px; border-radius:12px; font-weight:800; cursor:pointer;
      color:#fff; background:var(--btn-neutral);
      box-shadow:0 1px 0 rgba(0,0,0,.06), 0 6px 14px rgba(15,23,42,.14);
    }
    .btn-primary{ background:var(--btn-primary); }
    .btn-primary:hover{ background:var(--btn-primary-hover); }

    @media (max-width:480px){
      h1{ font-size:18px; }
      .modeTag{ font-size:16px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <span style="font-weight:800;">üåç</span>
        <h1>Country Time Zone Picker</h1>
      </div>
      <div class="modeTag">Local time: <span id="localTime">--:--</span></div>
    </header>

    <section class="card tzBar">
      <div class="tzRow">
        <label for="countrySearch" class="miniNote">Country</label>
        <div class="searchWrap">
          <input id="countrySearch" type="text" placeholder="Type country name..." autocomplete="off" />
          <div id="countryList" class="dropdown"></div>
        </div>
        <div class="chips">
          <div class="chip">Selected country: <span id="selCountry">None</span></div>
          <div class="chip">IANA zone: <span id="selZone">None</span></div>
          <div class="chip">UTC offset now: <span id="selOffset">--</span></div>
        </div>
      </div>
      <div class="controls">
        <button id="useSystemBtn" class="btn-primary">Use system time zone</button>
        <button id="clearBtn">Clear selection</button>
      </div>
    </section>

    <section class="card" style="margin-top:14px;">
      <div class="miniNote">Notes</div>
      <ul>
        <li>Each country maps to one representative IANA time zone (policy choices for multi-zone countries like US, CA, AU, BR, RU, etc.).</li>
        <li>Start typing a country name, then click a suggestion to set the time zone.</li>
        <li>This can be swapped to a library-backed list like countries-and-timezones for automatic data updates.</li>
      </ul>
    </section>
  </div>

  <script>
    // Persistent config
    const APP_KEY='country_tz_picker_v1';
    const GLOBAL_KEY=APP_KEY+'_global';
    const G = JSON.parse(localStorage.getItem(GLOBAL_KEY) || '{"timeZone":""}');

    // One canonical time zone per country (curated representatives)
    // This can be replaced or generated from countries-and-timezones in the future.
    // For brevity, a focused but broad set is included; extend as needed.
    const COUNTRY_TZ = [
      { name:'Afghanistan', tz:'Asia/Kabul' },
      { name:'Albania', tz:'Europe/Tirane' },
      { name:'Algeria', tz:'Africa/Algiers' },
      { name:'Andorra', tz:'Europe/Andorra' },
      { name:'Angola', tz:'Africa/Luanda' },
      { name:'Argentina', tz:'America/Argentina/Buenos_Aires' },
      { name:'Armenia', tz:'Asia/Yerevan' },
      { name:'Australia', tz:'Australia/Sydney' },     // policy: Sydney
      { name:'Austria', tz:'Europe/Vienna' },
      { name:'Azerbaijan', tz:'Asia/Baku' },
      { name:'Bahrain', tz:'Asia/Bahrain' },
      { name:'Bangladesh', tz:'Asia/Dhaka' },
      { name:'Belgium', tz:'Europe/Brussels' },
      { name:'Bhutan', tz:'Asia/Thimphu' },
      { name:'Bolivia', tz:'America/La_Paz' },
      { name:'Bosnia and Herzegovina', tz:'Europe/Sarajevo' },
      { name:'Botswana', tz:'Africa/Gaborone' },
      { name:'Brazil', tz:'America/Sao_Paulo' },       // policy: S√£o Paulo
      { name:'Brunei', tz:'Asia/Brunei' },
      { name:'Bulgaria', tz:'Europe/Sofia' },
      { name:'Cambodia', tz:'Asia/Phnom_Penh' },
      { name:'Cameroon', tz:'Africa/Douala' },
      { name:'Canada', tz:'America/Toronto' },         // policy: Toronto (ET)
      { name:'Chile', tz:'America/Santiago' },
      { name:'China', tz:'Asia/Shanghai' },
      { name:'Colombia', tz:'America/Bogota' },
      { name:'Congo (DRC)', tz:'Africa/Kinshasa' },
      { name:'Costa Rica', tz:'America/Costa_Rica' },
      { name:'Croatia', tz:'Europe/Zagreb' },
      { name:'Cyprus', tz:'Asia/Nicosia' },
      { name:'Czechia', tz:'Europe/Prague' },
      { name:'Denmark', tz:'Europe/Copenhagen' },
      { name:'Dominican Republic', tz:'America/Santo_Domingo' },
      { name:'Ecuador', tz:'America/Guayaquil' },
      { name:'Egypt', tz:'Africa/Cairo' },
      { name:'El Salvador', tz:'America/El_Salvador' },
      { name:'Estonia', tz:'Europe/Tallinn' },
      { name:'Ethiopia', tz:'Africa/Addis_Ababa' },
      { name:'Fiji', tz:'Pacific/Fiji' },
      { name:'Finland', tz:'Europe/Helsinki' },
      { name:'France', tz:'Europe/Paris' },
      { name:'Gabon', tz:'Africa/Libreville' },
      { name:'Georgia', tz:'Asia/Tbilisi' },
      { name:'Germany', tz:'Europe/Berlin' },
      { name:'Ghana', tz:'Africa/Accra' },
      { name:'Greece', tz:'Europe/Athens' },
      { name:'Guatemala', tz:'America/Guatemala' },
      { name:'Honduras', tz:'America/Tegucigalpa' },
      { name:'Hong Kong', tz:'Asia/Hong_Kong' },
      { name:'Hungary', tz:'Europe/Budapest' },
      { name:'Iceland', tz:'Atlantic/Reykjavik' },
      { name:'India', tz:'Asia/Kolkata' },
      { name:'Indonesia', tz:'Asia/Jakarta' },         // policy: Jakarta
      { name:'Iran', tz:'Asia/Tehran' },
      { name:'Iraq', tz:'Asia/Baghdad' },
      { name:'Ireland', tz:'Europe/Dublin' },
      { name:'Israel', tz:'Asia/Jerusalem' },
      { name:'Italy', tz:'Europe/Rome' },
      { name:'Japan', tz:'Asia/Tokyo' },
      { name:'Jordan', tz:'Asia/Amman' },
      { name:'Kazakhstan', tz:'Asia/Almaty' },         // policy: Almaty
      { name:'Kenya', tz:'Africa/Nairobi' },
      { name:'Kuwait', tz:'Asia/Kuwait' },
      { name:'Kyrgyzstan', tz:'Asia/Bishkek' },
      { name:'Laos', tz:'Asia/Vientiane' },
      { name:'Latvia', tz:'Europe/Riga' },
      { name:'Lebanon', tz:'Asia/Beirut' },
      { name:'Libya', tz:'Africa/Tripoli' },
      { name:'Lithuania', tz:'Europe/Vilnius' },
      { name:'Luxembourg', tz:'Europe/Luxembourg' },
      { name:'Madagascar', tz:'Indian/Antananarivo' },
      { name:'Malawi', tz:'Africa/Blantyre' },
      { name:'Malaysia', tz:'Asia/Kuala_Lumpur' },
      { name:'Maldives', tz:'Indian/Maldives' },
      { name:'Mali', tz:'Africa/Bamako' },
      { name:'Malta', tz:'Europe/Malta' },
      { name:'Mexico', tz:'America/Mexico_City' },     // policy: CDMX
      { name:'Moldova', tz:'Europe/Chisinau' },
      { name:'Mongolia', tz:'Asia/Ulaanbaatar' },
      { name:'Montenegro', tz:'Europe/Podgorica' },
      { name:'Morocco', tz:'Africa/Casablanca' },
      { name:'Mozambique', tz:'Africa/Maputo' },
      { name:'Myanmar', tz:'Asia/Yangon' },
      { name:'Namibia', tz:'Africa/Windhoek' },
      { name:'Nepal', tz:'Asia/Kathmandu' },
      { name:'Netherlands', tz:'Europe/Amsterdam' },
      { name:'New Zealand', tz:'Pacific/Auckland' },
      { name:'Nicaragua', tz:'America/Managua' },
      { name:'Niger', tz:'Africa/Niamey' },
      { name:'Nigeria', tz:'Africa/Lagos' },
      { name:'North Macedonia', tz:'Europe/Skopje' },
      { name:'Norway', tz:'Europe/Oslo' },
      { name:'Oman', tz:'Asia/Muscat' },
      { name:'Pakistan', tz:'Asia/Karachi' },
      { name:'Panama', tz:'America/Panama' },
      { name:'Paraguay', tz:'America/Asuncion' },
      { name:'Peru', tz:'America/Lima' },
      { name:'Philippines', tz:'Asia/Manila' },
      { name:'Poland', tz:'Europe/Warsaw' },
      { name:'Portugal', tz:'Europe/Lisbon' },
      { name:'Qatar', tz:'Asia/Qatar' },
      { name:'Romania', tz:'Europe/Bucharest' },
      { name:'Russia', tz:'Europe/Moscow' },           // policy: Moscow
      { name:'Rwanda', tz:'Africa/Kigali' },
      { name:'Saudi Arabia', tz:'Asia/Riyadh' },
      { name:'Senegal', tz:'Africa/Dakar' },
      { name:'Serbia', tz:'Europe/Belgrade' },
      { name:'Singapore', tz:'Asia/Singapore' },
      { name:'Slovakia', tz:'Europe/Bratislava' },
      { name:'Slovenia', tz:'Europe/Ljubljana' },
      { name:'South Africa', tz:'Africa/Johannesburg' },
      { name:'South Korea', tz:'Asia/Seoul' },
      { name:'Spain', tz:'Europe/Madrid' },
      { name:'Sri Lanka', tz:'Asia/Colombo' },
      { name:'Sweden', tz:'Europe/Stockholm' },
      { name:'Switzerland', tz:'Europe/Zurich' },
      { name:'Syria', tz:'Asia/Damascus' },
      { name:'Taiwan', tz:'Asia/Taipei' },
      { name:'Tanzania', tz:'Africa/Dar_es_Salaam' },
      { name:'Thailand', tz:'Asia/Bangkok' },
      { name:'Tunisia', tz:'Africa/Tunis' },
      { name:'T√ºrkiye', tz:'Europe/Istanbul' },
      { name:'Uganda', tz:'Africa/Kampala' },
      { name:'Ukraine', tz:'Europe/Kyiv' },
      { name:'United Arab Emirates', tz:'Asia/Dubai' },
      { name:'United Kingdom', tz:'Europe/London' },
      { name:'United States', tz:'America/New_York' }, // policy: New York (ET)
      { name:'Uruguay', tz:'America/Montevideo' },
      { name:'Uzbekistan', tz:'Asia/Tashkent' },
      { name:'Venezuela', tz:'America/Caracas' },
      { name:'Vietnam', tz:'Asia/Ho_Chi_Minh' },
      { name:'Zambia', tz:'Africa/Lusaka' },
      { name:'Zimbabwe', tz:'Africa/Harare' }
    ].sort((a,b)=> a.name.localeCompare(b.name));

    const countrySearch = document.getElementById('countrySearch');
    const countryList = document.getElementById('countryList');
    const selCountry = document.getElementById('selCountry');
    const selZone = document.getElementById('selZone');
    const selOffset = document.getElementById('selOffset');
    const useSystemBtn = document.getElementById('useSystemBtn');
    const clearBtn = document.getElementById('clearBtn');
    const localTimeEl = document.getElementById('localTime');

    function formatOffset(tz){
      try{
        const now=new Date();
        const parts=new Intl.DateTimeFormat('en-US',{ timeZone: tz, timeZoneName:'shortOffset' }).formatToParts(now);
        const tzName = parts.find(p=>p.type==='timeZoneName')?.value || '';
        return tzName;
      }catch{ return '--'; }
    }

    function setTimeZone(tz, countryName){
      G.timeZone = tz;
      localStorage.setItem(GLOBAL_KEY, JSON.stringify(G));
      selCountry.textContent = countryName || (COUNTRY_TZ.find(c=>c.tz===tz)?.name || '‚Äî');
      selZone.textContent = tz;
      selOffset.textContent = formatOffset(tz);
      countrySearch.value = selCountry.textContent;
    }

    function renderCountryList(filter=''){
      const q = filter.trim().toLowerCase();
      const items = COUNTRY_TZ.filter(c => c.name.toLowerCase().includes(q));
      if(items.length===0){ countryList.style.display='none'; countryList.innerHTML=''; return; }
      countryList.innerHTML = items.map(c=>`<div class="drop-item" data-tz="${c.tz}" data-name="${c.name}">${c.name}</div>`).join('');
      countryList.style.display='block';
    }

    countrySearch.addEventListener('input', ()=> renderCountryList(countrySearch.value) );
    countrySearch.addEventListener('focus', ()=> renderCountryList(countrySearch.value) );
    countryList.addEventListener('click', (e)=>{
      const item=e.target.closest('.drop-item'); if(!item) return;
      const name=item.getAttribute('data-name'); const tz=item.getAttribute('data-tz');
      setTimeZone(tz, name);
      countryList.style.display='none';
    });
    document.addEventListener('click', (e)=>{
      if(!countryList.contains(e.target) && e.target!==countrySearch){ countryList.style.display='none'; }
    });

    useSystemBtn.addEventListener('click', ()=>{
      const sys = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
      const match = COUNTRY_TZ.find(c=>c.tz===sys);
      setTimeZone(sys, match?.name || '');
    });
    clearBtn.addEventListener('click', ()=>{
      countrySearch.value=''; countryList.style.display='none';
      selCountry.textContent='None'; selZone.textContent='None'; selOffset.textContent='--';
      G.timeZone=''; localStorage.setItem(GLOBAL_KEY, JSON.stringify(G));
    });

    function tickLocal(){
      try{
        const tz = G.timeZone || Intl.DateTimeFormat().resolvedOptions().timeZone;
        const fmt = new Intl.DateTimeFormat('en-GB',{ timeZone: tz, hour:'2-digit', minute:'2-digit', second:'2-digit' });
        localTimeEl.textContent = fmt.format(new Date());
      }catch{
        localTimeEl.textContent = new Date().toLocaleTimeString();
      }
    }
    setInterval(tickLocal, 1000);
    tickLocal();

    // Prefill if saved
    (function init(){
      if(G.timeZone){
        const match = COUNTRY_TZ.find(c=>c.tz===G.timeZone);
        setTimeZone(G.timeZone, match?.name || '');
      }
    })();
  </script>

  <!-- Optional: swap curated list for a maintained DB in-browser
       <script src="https://cdn.jsdelivr.net/gh/manuelmhtr/countries-and-timezones@latest/dist/index.min.js"></script>
       You can then generate one tz per country (e.g., first or preferred), feeding COUNTRY_TZ dynamically.
  -->
</body>
</html>
